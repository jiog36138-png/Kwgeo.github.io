<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´‘ìš´ëŒ€í•™êµ ë§›ì§‘ ì¶”ì²œ - KW EATS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* [Design System] */
        :root {
            --primary-color: #8a1525;
            --primary-hover: #6b101d;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --text-main: #333333;
            --text-sub: #666666;
            --border-color: #e0e0e0;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --radius: 12px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Noto Sans KR', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .app-container {
            background: var(--card-bg);
            width: 100%;
            max-width: 480px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        /* [ë³€ê²½ í™•ì¸ìš©] í—¤ë”ë¥¼ íŒŒë€ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
        .header {
            background-color: #0054FF; /* í™•ì¸ìš© íŒŒë€ìƒ‰ */
            color: white;
            padding: 1rem;
            text-align: center;
        }
        .header h1 {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .content { padding: 2rem; }
        
        .page-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 2rem;
        }

        .form-group { margin-bottom: 1.8rem; }

        .form-label {
            display: block;
            font-weight: 700;
            margin-bottom: 0.8rem;
            color: var(--text-main);
            font-size: 0.95rem;
        }

        /* Range Slider */
        .range-container { position: relative; padding: 0 5px; }
        input[type=range] {
            width: 100%; height: 6px; background: #ddd; border-radius: 5px; outline: none; -webkit-appearance: none;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; width: 20px; height: 20px; border-radius: 50%; background: var(--primary-color); cursor: pointer;
        }
        .hunger-value { text-align: right; font-size: 0.85rem; color: var(--text-sub); margin-top: 5px; }

        /* Chips */
        .chip-group { display: flex; flex-wrap: wrap; gap: 8px; }
        .chip-input { display: none; }
        .chip-label {
            padding: 8px 16px; background-color: #fff; border: 1px solid var(--border-color); border-radius: 20px;
            font-size: 0.9rem; color: var(--text-sub); cursor: pointer; transition: all 0.2s ease;
        }
        .chip-input:checked + .chip-label {
            background-color: var(--primary-color); color: white; border-color: var(--primary-color); font-weight: 500;
        }

        /* Inputs */
        .input-group { position: relative; }
        .input-field {
            width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 1rem; outline: none;
        }
        .unit { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: var(--text-sub); font-size: 0.9rem; }

        /* Button */
        .btn-submit {
            width: 100%; padding: 16px; background-color: var(--primary-color); color: white; border: none;
            border-radius: 8px; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: background-color 0.3s; margin-top: 1rem;
        }
        .btn-submit:disabled { background-color: #ccc; cursor: not-allowed; }

        /* Results */
        #statusMessage { margin-top: 15px; text-align: center; font-size: 0.9rem; min-height: 20px; }
        #resultsContainer { margin-top: 30px; }
        .result-card {
            background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 15px;
            margin-top: 12px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        .result-card h3 { color: var(--primary-color); margin-bottom: 5px; font-size: 1.1rem; }
    </style>
</head>
<body>

    <div class="app-container">
        <header class="header">
            <h1>KWANGWOON EATS (SERVER)</h1>
        </header>

        <div class="content">
            <h2 class="page-title">ë§›ì§‘ ì¶”ì²œ (ì„œë²„ ì—°ê²°ë¨)</h2>

            <form id="recommendForm" onsubmit="event.preventDefault(); register();">
                <div class="form-group">
                    <label class="form-label">ë°°ê³ í”” ì •ë„</label>
                    <div class="range-container">
                        <input type="range" id="hunger" min="0" max="100" value="50" oninput="updateHunger(this.value)">
                    </div>
                    <div class="hunger-value"><span id="hungerText">50</span>%</div>
                </div>

                <div class="form-group">
                    <label class="form-label">ì‹ì‚¬ ì‹œê°„</label>
                    <div class="chip-group">
                        <input type="radio" name="mealTime" id="time1" value="ì•„ì¹¨" class="chip-input"><label for="time1" class="chip-label">ì•„ì¹¨</label>
                        <input type="radio" name="mealTime" id="time2" value="ì ì‹¬" class="chip-input" checked><label for="time2" class="chip-label">ì ì‹¬</label>
                        <input type="radio" name="mealTime" id="time3" value="ì €ë…" class="chip-input"><label for="time3" class="chip-label">ì €ë…</label>
                        <input type="radio" name="mealTime" id="time4" value="ì•¼ì‹" class="chip-input"><label for="time4" class="chip-label">ì•¼ì‹</label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">ì›í•˜ëŠ” ì¢…ë¥˜</label>
                    <div class="chip-group">
                        <input type="radio" name="cuisine" id="food1" value="í•œì‹" class="chip-input" checked><label for="food1" class="chip-label">í•œì‹</label>
                        <input type="radio" name="cuisine" id="food2" value="ì¤‘ì‹" class="chip-input"><label for="food2" class="chip-label">ì¤‘ì‹</label>
                        <input type="radio" name="cuisine" id="food3" value="ì–‘ì‹" class="chip-input"><label for="food3" class="chip-label">ì–‘ì‹</label>
                        <input type="radio" name="cuisine" id="food4" value="ì¼ì‹" class="chip-input"><label for="food4" class="chip-label">ì¼ì‹</label>
                        <input type="radio" name="cuisine" id="food5" value="ë””ì €íŠ¸" class="chip-input"><label for="food5" class="chip-label">ë””ì €íŠ¸</label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">ì˜ˆì‚° (1ì¸)</label>
                    <div class="input-group">
                        <input type="number" id="price" class="input-field" value="10000" placeholder="10000">
                        <span class="unit">ì›</span>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">ê±°ë¦¬ (ë„ë³´)</label>
                    <div class="chip-group">
                        <input type="radio" name="distance" id="dist1" value="5" class="chip-input" checked><label for="dist1" class="chip-label">5ë¶„</label>
                        <input type="radio" name="distance" id="dist2" value="10" class="chip-input"><label for="dist2" class="chip-label">10ë¶„</label>
                        <input type="radio" name="distance" id="dist3" value="20" class="chip-input"><label for="dist3" class="chip-label">20ë¶„</label>
                    </div>
                </div>

                <button type="submit" class="btn-submit">ì„œë²„ì— ìš”ì²­í•˜ê¸°</button>
            </form>
            <div id="statusMessage"></div>
            <div id="resultsContainer"></div>
        </div>
    </div>

    <script>
        function updateHunger(val) { document.getElementById('hungerText').innerText = val; }
        function showStatus(msg, isError = false) {
            const el = document.getElementById('statusMessage');
            el.innerText = msg; el.style.color = isError ? '#d32f2f' : '#2e7d32';
        }

        // [ì¤‘ìš”] ì„œë²„ í†µì‹ ìš© í•¨ìˆ˜ (ë¡œì»¬ ë°ì´í„° ì—†ìŒ)
        async function register() {
            const submitButton = document.querySelector('.btn-submit');
            const resultsContainer = document.getElementById('resultsContainer');
            
            // ê°’ ê°€ì ¸ì˜¤ê¸°
            const hungerVal = document.getElementById('hunger').value;
            const priceVal = document.getElementById('price').value;
            const mealTimeVal = document.querySelector('input[name="mealTime"]:checked')?.value;
            const cuisineVal = document.querySelector('input[name="cuisine"]:checked')?.value;
            const distanceVal = document.querySelector('input[name="distance"]:checked')?.value;

            const requestData = {
                hunger: parseInt(hungerVal),
                mealTime: mealTimeVal,
                cuisine: cuisineVal,
                price: parseInt(priceVal),
                distance: distanceVal
            };

            resultsContainer.innerHTML = '';
            submitButton.disabled = true;
            showStatus("ğŸš€ ì„œë²„(FastAPI)ë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” ì¤‘...");

            try {
                // Replit URL ì£¼ì˜ (ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš©)
                const response = await fetch('http://localhost:8000/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestData),
                });

                const result = await response.json();

                if (response.ok && result.status === 'success') {
                    showStatus(`âœ… í†µì‹  ì„±ê³µ!`);
                    resultsContainer.innerHTML = `
                        <div class="result-card">
                            <h3>ì‘ë‹µ ì„±ê³µ</h3>
                            <p>ì„œë²„ ë©”ì‹œì§€: ${result.message}</p>
                            <pre style="background:#eee; padding:10px;">${JSON.stringify(result.received_data, null, 2)}</pre>
                        </div>
                    `;
                } else {
                    throw new Error("ì„œë²„ ì˜¤ë¥˜");
                }
            } catch (error) {
